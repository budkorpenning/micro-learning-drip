export const SUPPORTED_LANGUAGES = ['en', 'sv'] as const;
export type SupportedLanguage = typeof SUPPORTED_LANGUAGES[number];

const translations = {
  en: {
    'nav.addCard': 'Add Card',
    'nav.review': 'Review',
    'nav.deck': 'Deck',
    'nav.library': 'Library',
    'nav.createDeck': 'Create Deck',
    'nav.modal': 'Modal',
    'tabs.today': 'Today',
    'tabs.library': 'Library',
    'tabs.stats': 'Stats',
    'tabs.settings': 'Settings',
    'login.title': 'Micro Learning Drip',
    'login.subtitle': 'Your daily learning companion',
    'login.signIn': 'Sign in with Google',
    'login.signInFailed': 'Sign in failed',
    'today.itemsToReview_one': '{{count}} item to review',
    'today.itemsToReview_other': '{{count}} items to review',
    'today.reviewPrompt': 'Review →',
    'today.emptyTitle': 'All caught up!',
    'today.emptySubtitle': "Great job! You've reviewed all your due items.",
    'today.nextUp': 'Next up: "{{title}}" {{when}}',
    'today.noNext': 'Add items in the Library tab to start learning!',
    'today.errorLoad': 'Failed to load items',
    'relative.inDays_one': 'in {{count}} day',
    'relative.inDays_other': 'in {{count}} days',
    'relative.inHours_one': 'in {{count}} hour',
    'relative.inHours_other': 'in {{count}} hours',
    'relative.tomorrow': 'tomorrow',
    'relative.soon': 'soon',
    'library.errorLoad': 'Failed to load decks',
    'library.errorUpdate': 'Failed to update deck',
    'library.cardCount_one': '{{count}} card',
    'library.cardCount_other': '{{count}} cards',
    'library.emptyArchived': 'No archived decks',
    'library.emptyActive': 'Create your first deck',
    'library.emptyActiveHint': 'Tap + to get started',
    'deck.errorLoad': 'Failed to load deck',
    'deck.errorUpdateItem': 'Failed to update item',
    'deck.archiveDisabled': 'Deck archived',
    'deck.emptyArchived': 'No archived cards',
    'deck.emptyActive': 'No cards yet. Tap + to add your first card.',
    'deck.titleFallback': 'Deck',
    'createDeck.label': 'Deck Name *',
    'createDeck.placeholder': 'e.g. Spanish Vocabulary',
    'createDeck.error': 'Failed to create deck',
    'createDeck.button': 'Create Deck',
    'addItem.questionLabel': 'Question *',
    'addItem.questionPlaceholder': 'Enter your question',
    'addItem.answerLabel': 'Answer *',
    'addItem.answerPlaceholder': 'Enter the answer',
    'addItem.sourceLabel': 'Source URL (optional)',
    'addItem.tagsLabel': 'Tags (optional, comma-separated)',
    'addItem.tagsPlaceholder': 'e.g. programming, react, hooks',
    'addItem.error': 'Failed to create item',
    'addItem.button': 'Add Card',
    'review.question': 'Question',
    'review.answer': 'Answer',
    'review.reveal': 'Reveal answer',
    'review.prompt': 'How well did you remember this?',
    'review.errorLoad': 'Failed to load item',
    'review.errorSubmit': 'Failed to submit review',
    'review.errorOpenUrl': 'Could not open URL',
    'review.notFound': 'Item not found',
    'review.grade.forgot': 'Forgot',
    'review.grade.hard': 'Hard',
    'review.grade.good': 'Good',
    'review.grade.easy': 'Easy',
    'settings.titleAppearance': 'Appearance',
    'settings.titleReminders': 'Reminders',
    'settings.titleDiagnostics': 'Diagnostics (DEV)',
    'settings.titleAccount': 'Account',
    'settings.themeLabel': 'Theme',
    'settings.theme.system': 'System',
    'settings.theme.light': 'Light',
    'settings.theme.dark': 'Dark',
    'settings.languageLabel': 'Language',
    'settings.language.english': 'English',
    'settings.language.swedish': 'Swedish',
    'settings.notifications': 'Notifications',
    'settings.dailyReminder': 'Daily reminder',
    'settings.timezone': 'Timezone',
    'settings.useDevice': 'Use device',
    'settings.done': 'Done',
    'settings.signOut': 'Sign out',
    'settings.signingOut': 'Signing out...',
    'settings.errorLoad': 'Failed to load settings',
    'settings.errorSave': 'Failed to save',
    'settings.diagnostics.pushPermission': 'Push permission',
    'settings.diagnostics.deviceToken': 'Device token saved',
    'settings.diagnostics.physicalDevice': 'Physical device',
    'settings.diagnostics.yes': 'Yes',
    'settings.diagnostics.no': 'No',
    'settings.diagnostics.simulator': 'Simulator',
    'stats.errorLoad': 'Failed to load stats',
    'stats.overview': 'Overview',
    'stats.total': 'Total',
    'stats.dueNow': 'Due now',
    'stats.streak': 'Streak',
    'stats.itemsProgress': 'Items Progress',
    'stats.learning': 'Learning',
    'stats.reviewing': 'Reviewing',
    'stats.mastered': 'Mastered',
    'stats.totalActive': 'Total Active',
    'stats.reviewed': 'Reviewed',
    'modal.title': 'This is a modal',
    'modal.goHome': 'Go to home screen',
    'common.active': 'Active',
    'common.archived': 'Archived',
    'common.archive': 'Archive',
    'common.unarchive': 'Unarchive',
  },
  sv: {
    'nav.addCard': 'Lägg till kort',
    'nav.review': 'Repetition',
    'nav.deck': 'Kortlek',
    'nav.library': 'Bibliotek',
    'nav.createDeck': 'Skapa kortlek',
    'nav.modal': 'Modal',
    'tabs.today': 'Idag',
    'tabs.library': 'Bibliotek',
    'tabs.stats': 'Statistik',
    'tabs.settings': 'Inställningar',
    'login.title': 'Micro Learning Drip',
    'login.subtitle': 'Din dagliga lärkompanjon',
    'login.signIn': 'Logga in med Google',
    'login.signInFailed': 'Inloggning misslyckades',
    'today.itemsToReview_one': '{{count}} kort att repetera',
    'today.itemsToReview_other': '{{count}} kort att repetera',
    'today.reviewPrompt': 'Repetera →',
    'today.emptyTitle': 'Du är ikapp!',
    'today.emptySubtitle': 'Bra jobbat! Du har repeterat alla förfallna kort.',
    'today.nextUp': 'Nästa: "{{title}}" {{when}}',
    'today.noNext': 'Lägg till kort i Bibliotek-fliken för att komma igång!',
    'today.errorLoad': 'Kunde inte läsa in kort',
    'relative.inDays_one': 'om {{count}} dag',
    'relative.inDays_other': 'om {{count}} dagar',
    'relative.inHours_one': 'om {{count}} timme',
    'relative.inHours_other': 'om {{count}} timmar',
    'relative.tomorrow': 'i morgon',
    'relative.soon': 'snart',
    'library.errorLoad': 'Kunde inte läsa in kortlekar',
    'library.errorUpdate': 'Kunde inte uppdatera kortleken',
    'library.cardCount_one': '{{count}} kort',
    'library.cardCount_other': '{{count}} kort',
    'library.emptyArchived': 'Inga arkiverade kortlekar',
    'library.emptyActive': 'Skapa din första kortlek',
    'library.emptyActiveHint': 'Tryck på + för att komma igång',
    'deck.errorLoad': 'Kunde inte läsa in kortleken',
    'deck.errorUpdateItem': 'Kunde inte uppdatera kortet',
    'deck.archiveDisabled': 'Kortleken är arkiverad',
    'deck.emptyArchived': 'Inga arkiverade kort',
    'deck.emptyActive': 'Inga kort ännu. Tryck på + för att lägga till ditt första kort.',
    'deck.titleFallback': 'Kortlek',
    'createDeck.label': 'Kortleksnamn *',
    'createDeck.placeholder': 't.ex. Spanska glosor',
    'createDeck.error': 'Kunde inte skapa kortlek',
    'createDeck.button': 'Skapa kortlek',
    'addItem.questionLabel': 'Fråga *',
    'addItem.questionPlaceholder': 'Skriv din fråga',
    'addItem.answerLabel': 'Svar *',
    'addItem.answerPlaceholder': 'Skriv svaret',
    'addItem.sourceLabel': 'Käll-URL (valfritt)',
    'addItem.tagsLabel': 'Taggar (valfritt, kommaseparerade)',
    'addItem.tagsPlaceholder': 't.ex. programmering, react, hooks',
    'addItem.error': 'Kunde inte skapa kort',
    'addItem.button': 'Lägg till kort',
    'review.question': 'Fråga',
    'review.answer': 'Svar',
    'review.reveal': 'Visa svar',
    'review.prompt': 'Hur bra mindes du detta?',
    'review.errorLoad': 'Kunde inte läsa in kortet',
    'review.errorSubmit': 'Kunde inte spara repetitionen',
    'review.errorOpenUrl': 'Kunde inte öppna länken',
    'review.notFound': 'Kortet hittades inte',
    'review.grade.forgot': 'Glömt',
    'review.grade.hard': 'Svårt',
    'review.grade.good': 'Bra',
    'review.grade.easy': 'Lätt',
    'settings.titleAppearance': 'Utseende',
    'settings.titleReminders': 'Påminnelser',
    'settings.titleDiagnostics': 'Diagnostik (DEV)',
    'settings.titleAccount': 'Konto',
    'settings.themeLabel': 'Tema',
    'settings.theme.system': 'System',
    'settings.theme.light': 'Ljust',
    'settings.theme.dark': 'Mörkt',
    'settings.languageLabel': 'Språk',
    'settings.language.english': 'Engelska',
    'settings.language.swedish': 'Svenska',
    'settings.notifications': 'Notiser',
    'settings.dailyReminder': 'Daglig påminnelse',
    'settings.timezone': 'Tidszon',
    'settings.useDevice': 'Använd enheten',
    'settings.done': 'Klar',
    'settings.signOut': 'Logga ut',
    'settings.signingOut': 'Loggar ut...',
    'settings.errorLoad': 'Kunde inte läsa in inställningar',
    'settings.errorSave': 'Kunde inte spara',
    'settings.diagnostics.pushPermission': 'Push-behörighet',
    'settings.diagnostics.deviceToken': 'Enhetstoken sparad',
    'settings.diagnostics.physicalDevice': 'Fysisk enhet',
    'settings.diagnostics.yes': 'Ja',
    'settings.diagnostics.no': 'Nej',
    'settings.diagnostics.simulator': 'Simulator',
    'stats.errorLoad': 'Kunde inte läsa in statistik',
    'stats.overview': 'Översikt',
    'stats.total': 'Totalt',
    'stats.dueNow': 'Förfaller nu',
    'stats.streak': 'Svit',
    'stats.itemsProgress': 'Kortens status',
    'stats.learning': 'Lärande',
    'stats.reviewing': 'Repetition',
    'stats.mastered': 'Bemästrade',
    'stats.totalActive': 'Totalt aktiva',
    'stats.reviewed': 'Repetitioner',
    'modal.title': 'Detta är en modal',
    'modal.goHome': 'Gå till startsidan',
    'common.active': 'Aktiva',
    'common.archived': 'Arkiverade',
    'common.archive': 'Arkivera',
    'common.unarchive': 'Avarkivera',
  },
} as const;

export type TranslationKey = keyof typeof translations.en;

export function isSupportedLanguage(value: string | null | undefined): value is SupportedLanguage {
  return value === 'en' || value === 'sv';
}

export function getLocale(language: SupportedLanguage): string {
  return language === 'sv' ? 'sv-SE' : 'en-US';
}

export function t(
  language: SupportedLanguage,
  key: TranslationKey,
  params?: Record<string, string | number>
): string {
  const template = translations[language][key] ?? translations.en[key] ?? key;
  if (!params) return template;

  return template.replace(/\{\{(\w+)\}\}/g, (match, paramKey) => {
    const value = params[paramKey];
    return value === undefined ? match : String(value);
  });
}
